{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.6", "generated_at": "2025-06-19T18:39:29.868946Z", "invocation_id": "16025bc1-faec-4ab5-b541-ffbb860cbe56", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.432673Z", "completed_at": "2025-06-19T18:39:29.439948Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.440269Z", "completed_at": "2025-06-19T18:39:29.440282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00929880142211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main.tb_sku_bronze", "compiled": true, "compiled_code": "\n\nselect\n    sku,\n    valor,\n    tipo,\n    current_timestamp as ingestion_timestamp\nfrom `psql_neon`.`raw`.`tb_sku`", "relation_name": "`dbw_eastus`.`bronze`.`tb_sku_bronze`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.441746Z", "completed_at": "2025-06-19T18:39:29.443035Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.443392Z", "completed_at": "2025-06-19T18:39:29.443398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0024666786193847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.main.depara_sku", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.444768Z", "completed_at": "2025-06-19T18:39:29.460930Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.461250Z", "completed_at": "2025-06-19T18:39:29.461257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01730179786682129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.dbt_expectations_source_expect_column_values_to_match_regex_neon_federation_dbw_tb_sku_TIPO__i__True___A_Za_z_1_.ef2b30a323", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\n    \n\nlength(regexp_extract(TIPO, '^[A-Za-z]{1}$', 0))\n\n\n > 0\n as expression\n\n\n    from `psql_neon`.`raw`.`tb_sku`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.463871Z", "completed_at": "2025-06-19T18:39:29.485098Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.485603Z", "completed_at": "2025-06-19T18:39:29.485615Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023632287979125977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.source_not_null_neon_federation_dbw_tb_sku_VALOR.782f27ace1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect VALOR\nfrom `psql_neon`.`raw`.`tb_sku`\nwhere VALOR is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.488613Z", "completed_at": "2025-06-19T18:39:29.494417Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.494846Z", "completed_at": "2025-06-19T18:39:29.494856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008049488067626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main.tb_sku_silver", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        DISTINCT\n        sku,\n        valor,\n        tipo,\n        ingestion_timestamp\n    from `dbw_eastus`.`bronze`.`tb_sku_bronze`\n\n)\nselect \n    *,\n    \n            \n    (case when valor is null then 1 else 0 end)\n as valor_has_null, \n    \n            \n    (case when tipo is null then 1 else 0 end)\n as tipo_has_null\n    \nfrom source_data", "relation_name": "`dbw_eastus`.`silver`.`tb_sku_silver`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.496799Z", "completed_at": "2025-06-19T18:39:29.500440Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.501157Z", "completed_at": "2025-06-19T18:39:29.501183Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005512714385986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.main.tb_sku_snapshot", "compiled": true, "compiled_code": "\n    \n    \n    select\n        sku,\n        valor,\n        tipo\n    from `dbw_eastus`.`bronze`.`tb_sku_bronze`\n    \n    ", "relation_name": "`dbw_eastus`.`silver`.`tb_sku_snapshot`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.503830Z", "completed_at": "2025-06-19T18:39:29.507923Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.508240Z", "completed_at": "2025-06-19T18:39:29.508248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005644798278808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.main.tb_sku_gold", "compiled": true, "compiled_code": "\n\n\n\nselect\n    DISTINCT\n    silver.sku,\n    depara_sku.campanha AS nome_campanha,\n    to_date(\n        case\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Janeiro/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Janeiro', 'January')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Fevereiro/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Fevereiro', 'February')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Mar\u00e7o/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Mar\u00e7o', 'March')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Abril/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Abril', 'April')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Maio/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Maio', 'May')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Junho/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Junho', 'June')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Julho/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Julho', 'July')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Agosto/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Agosto', 'August')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Setembro/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Setembro', 'September')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Outubro/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Outubro', 'October')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Novembro/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Novembro', 'November')\n            \n                when split(depara_sku.campanha, ' ', -1)[1] like 'Dezembro/%' then\n                    replace(split(depara_sku.campanha, ' ', -1)[1], 'Dezembro', 'December')\n            \n            else null\n        end,\n        'MMMM/yy'\n    ) data_campanha,\n    silver.valor,\n    silver.tipo\nFROM `dbw_eastus`.`silver`.`tb_sku_silver` AS silver\nLEFT JOIN `dbw_eastus`.`silver`.`tb_sku_seed` AS depara_sku\nON silver.sku = depara_sku.sku\nORDER BY\n    silver.sku", "relation_name": "`dbw_eastus`.`gold`.`tb_sku_gold`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.510077Z", "completed_at": "2025-06-19T18:39:29.517670Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.517985Z", "completed_at": "2025-06-19T18:39:29.517993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009032249450683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.dbt_utils_not_accepted_values_tb_sku_silver_TIPO_____N_A__null.c47c145d28", "compiled": true, "compiled_code": "\nwith all_values as (\n\n    select distinct\n        TIPO as value_field\n\n    from `dbw_eastus`.`silver`.`tb_sku_silver`\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field in (\n        '-','N/A','null'\n        )\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.519463Z", "completed_at": "2025-06-19T18:39:29.523373Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.523687Z", "completed_at": "2025-06-19T18:39:29.523694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005054473876953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.not_null_tb_sku_silver_SKU.f1276a5e53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect SKU\nfrom `dbw_eastus`.`silver`.`tb_sku_silver`\nwhere SKU is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.525206Z", "completed_at": "2025-06-19T18:39:29.529295Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.529629Z", "completed_at": "2025-06-19T18:39:29.529637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005305051803588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.test_greater_than_tb_sku_silver_VALOR__10.8689511c39", "compiled": true, "compiled_code": "\n    select\n        *\n    from `dbw_eastus`.`silver`.`tb_sku_silver`\n    where VALOR > 10\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.531343Z", "completed_at": "2025-06-19T18:39:29.536887Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.537176Z", "completed_at": "2025-06-19T18:39:29.537182Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006774187088012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.unique_tb_sku_silver_SKU.898ff9dd59", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    SKU as unique_field,\n    count(*) as n_records\n\nfrom `dbw_eastus`.`silver`.`tb_sku_silver`\nwhere SKU is not null\ngroup by SKU\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.538693Z", "completed_at": "2025-06-19T18:39:29.541371Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.541667Z", "completed_at": "2025-06-19T18:39:29.541675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038743019104003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.main.top_four", "compiled": true, "compiled_code": "-- Compilado e documentado, mas n\u00e3o executado por dbt run.\nwith topfour as (\n    select\n        sku,\n        valor\n    from `dbw_eastus`.`gold`.`tb_sku_gold`\n    where valor is not null\n    order by valor desc\n    limit 4\n)\nselect\n    sku,\n    valor\nfrom topfour", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-19T18:39:29.543149Z", "completed_at": "2025-06-19T18:39:29.545411Z"}, {"name": "execute", "started_at": "2025-06-19T18:39:29.545671Z", "completed_at": "2025-06-19T18:39:29.545678Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003343343734741211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.main.assert_campaign_not_exists", "compiled": true, "compiled_code": "-- Campanhas futuras n\u00e3o podem existir com valor\nselect \n    *\nfrom `dbw_eastus`.`gold`.`tb_sku_gold` as gold\nwhere 1=1\nAND data_campanha > current_date()\nAND valor is not null", "relation_name": null, "batch_results": null}], "elapsed_time": 3.1168947219848633, "args": {"require_batched_execution_for_custom_microbatch_strategy": false, "quiet": false, "cache_selected_only": false, "print": true, "strict_mode": false, "favor_state": false, "printer_width": 80, "require_explicit_package_overrides_for_builtin_materializations": true, "state_modified_compare_vars": false, "defer": false, "state_modified_compare_more_unrendered_values": false, "select": [], "require_nested_cumulative_type_params": false, "log_level": "info", "use_colors_file": true, "exclude": [], "compile": true, "log_path": "/home/host01/Documentos/dbt/main/logs", "indirect_selection": "eager", "show_resource_report": false, "vars": {}, "populate_cache": true, "introspect": true, "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "log_level_file": "debug", "source_freshness_run_project_hooks": false, "log_format_file": "debug", "empty_catalog": false, "project_dir": "/home/host01/Documentos/dbt/main", "write_json": true, "send_anonymous_usage_stats": true, "invocation_command": "dbt docs generate --profiles-dir .", "which": "generate", "macro_debugging": false, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "require_resource_names_without_spaces": false, "log_format": "default", "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "use_colors": true, "static": false, "profiles_dir": "."}}